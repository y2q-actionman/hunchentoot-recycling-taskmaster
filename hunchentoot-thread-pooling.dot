digraph thread_pooling_architecture {
    rankdir=TB;
    splines=true;
    nodesep=0.8;
    ranksep=1.2;

    fontsize=20;
    labelloc="t";
    label="Thread-pooling Model";

    node [style=filled, color=white, shape=ellipse, fontsize=14];
    edge [fontsize=12];

    listen_socket [label="Listen Socket", shape=cylinder, style=filled, color=lightblue];

    acceptor [label="Acceptor Thread"];

    acceptor -> listen_socket [label="calls accept()", style=dashed];
    listen_socket -> acceptor [label="gets connection", color=blue];

    queue [label="Queue", shape=cylinder, style=filled, color=lightblue];
    acceptor -> queue [label="enqueue", color=blue];


    subgraph cluster_req1 {
        label="Worker 1";
        style=dotted;
        handler_1 [label="Handler Thread 1"];
    }

    subgraph cluster_req2 {
        label="Worker 2";
        style=dotted;
        handler_2 [label="Handler Thread 2"];
    }

    subgraph cluster_req3 {
        label="Worker 3";
        style=dotted;
        handler_3 [label="Handler Thread 3"];
    }

    queue -> handler_1 [label="dequeue", color=blue];
    queue -> handler_2 [color=blue];
    queue -> handler_3 [color=blue];

    handler_1 -> queue [style=dashed, color=darkgreen];
    handler_2 -> queue [style=dashed, color=darkgreen];
    handler_3 -> queue [style=dashed, color=darkgreen];
}
