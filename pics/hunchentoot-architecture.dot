digraph traditional_architecture {
    size="8,6";
    
    rankdir=TB;
    splines=true;
    nodesep=0.8;
    ranksep=1.2;

    fontsize=20;
    labelloc="t";
    label="Traditional Hunchentoot Thread Model";

    node [style=filled, color=white, shape=ellipse, fontsize=14];
    edge [fontsize=12];

    listen_socket [label="Listen Socket", shape=cylinder, style=filled, color=lightblue];

    acceptor [label="Acceptor Thread"];
    
    acceptor -> listen_socket [label="calls accept()", style=dashed];
    listen_socket -> acceptor [label="gets connection", color=blue];
    
    subgraph cluster_req1 {
        label="Request 1";
        style=dotted;
        handler_1 [label="Handler Thread 1"];
    }

    subgraph cluster_req2 {
        label="Request 2";
        style=dotted;
        handler_2 [label="Handler Thread 2"];
    }

    subgraph cluster_req3 {
        label="Request 3";
        style=dotted;
        handler_3 [label="Handler Thread 3"];
    }

    acceptor -> handler_1 [label="spawns", color=blue];
    acceptor -> handler_2 [label="spawns", color=blue];
    acceptor -> handler_3 [label="spawns", color=blue];
    
    handler_1 -> "" [label="handles & terminates", shape=plaintext, fontcolor=red, color=red, style=dashed];
    handler_2 -> " " [label="handles & terminates", shape=plaintext, fontcolor=red, color=red, style=dashed];
    handler_3 -> "  " [label="handles & terminates", shape=plaintext, fontcolor=red, color=red, style=dashed];
}
